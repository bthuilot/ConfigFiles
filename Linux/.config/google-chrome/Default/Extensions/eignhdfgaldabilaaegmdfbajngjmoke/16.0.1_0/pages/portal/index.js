cjModules.define(function(){"use strict";return function(e){function t(){return g.initialized.then(function(){var e=Object.keys(bmRuntime.servicePageData);return"none"!==g.account.pageid?e.filter(function(e){return bmRuntime.servicePageData[e].gplusPages}):bmRuntime.portalOnSide?new Promise(function(e){bmRuntime.selectedServices.get(e)}):e})}function n(){var e=cjMaterial.createElement("appbar",{light:c});if(c){var t=cjMaterial.createElement("title",{label:i[(new Date).getMonth()]+" "+(new Date).getDate()});e.appendChild(t)}var n=cjMaterial.createElement("iconbutton",{iconName:"__mdi:apps",onClick:function(e){bmRuntime.changeToPage(c?"gapplauncher":"applauncher"),e.stopPropagation()}});e.appendChild(n);var a;return c||(a=cjMaterial.createElement("iconbutton",{iconName:"__mdi:settings",onClick:function(){bmRuntime.changeToPage("blackmenusettings")}}),e.appendChild(a)),g.initialized.then(function(){if(g.signedIn){var t=cjMaterial.createElement("iconbutton",{iconName:"__mdi:cj_notifications_circle",onClick:function(e){bmRuntime.changeToPage("notifications"),e.stopPropagation()}});t.classList.add("bm-notif-iconbuton"),e.insertBefore(t,a);var n=bmElements.createElement("accountbutton");e.appendChild(n),cjgOgs.getNotificationsCount(g.account).then(function(e){e&&(t.dataset.count=e)})}else{var i=bmElements.createElement("signinbutton");e.appendChild(i)}}),e}function a(){if(bmRuntime.portalOnSide){c||e.classList.add("cj-md--dark");var a=n();e.appendChild(a)}var i=cjMaterial.createElement("container",{scrollable:!0,shadow:"onScroll"});r.className="portal-subcontainer",i.appendChild(r),bmRuntime.portalOnSide&&(r.addEventListener("dragover",function(e){e.preventDefault()}),r.addEventListener("drop",function(e){e.preventDefault(),document.querySelector(".main-window > .remove-page").classList.remove("on");var t=e.dataTransfer.getData("serviceId"),n=bmRuntime.servicePageData[t].menuItem,a=e.target;if(a===r)a.insertBefore(n,bmRuntime.servicePageData.customize.menuItem);else{var i=a;!c&&e.offsetY>24&&a.nextSibling&&"customize"!==a.nextSibling.dataset.id&&(i=a.nextSibling),a.parentNode.insertBefore(n,i)}for(var o=[],m=bmRuntime.portalPageServicesList.querySelectorAll(".page-menu-item"),u=0;u<m.length;u++){var s=m[u].dataset.id;"customize"!==s&&o.push(s)}bmRuntime.selectedServices.set(o)})),t().then(function(e){var t=document.createDocumentFragment();e.forEach(function(e){var n=bmRuntime.servicePageData[e];if(n&&(!n.hidden||bmRuntime.isDev)){var a=bmRuntime.createMenuItem(e);t.appendChild(a)}});var n=cjMaterial.createElement("item",{icon:{name:"add",size:32},label:bmRuntime.i18n("cj_i18n_00082","Add")});n.dataset.id="customize",n.classList.add("page-menu-item"),n.addEventListener("click",function(){bmRuntime.changeToPage("customize")}),bmRuntime.servicePageData.customize.menuItem=n,"none"===g.account.pageid&&t.appendChild(n),t.firstChild.classList.add("selected"),r.appendChild(t)}),e.appendChild(i),window.addEventListener("bm-page-change",function(){var e=document.querySelector(".main-window").selected,t=document.querySelector(".page-menu-item.selected");t&&t.classList.remove("selected");var n=document.querySelector(".page-menu-item[data-id='"+e+"']");n&&n.classList.add("selected")})}var i=["January","February","March","April","May","June","July","August","September","October","November","December"],c="newtab"===bmRuntime.environment,r=document.createElement("ul");bmRuntime.portalPageServicesList=r,a()}});