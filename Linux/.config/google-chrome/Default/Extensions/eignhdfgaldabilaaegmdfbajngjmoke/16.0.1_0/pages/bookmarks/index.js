cjModules.define(function(){"use strict";return function(e,t){function a(){return g.cache.getItem("bm__cache__bookmarks__bookmarks").then(function(e){return e||{bookmarks:[],labels:[]}})}function n(e){var t=new Date(e),a=[t.getFullYear(),t.getMonth(),t.getDate()];return cjBasics.datetime.printLegacyDate(a)}function l(){var t=cjMaterial.createElement("appbar",{color:"#fff",secondary:!0,light:!0}),a=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){u.open()}});t.appendChild(a),b=cjMaterial.createElement("title",{label:bmRuntime.i18n("cj_i18n_00008","All bookmarks")}),t.appendChild(b);var n=cjMaterial.createElement("fab",{label:bmRuntime.i18n("cj_i18n_00009","Add bookmark"),iconName:"__mdi:add",onClick:function(){bmRuntime.openTab("https://www.google.com/bookmarks/mark?op=add&authuser="+g.account.authuser)}});e.appendChild(n);var l=cjMaterial.createElement("button",{color:"#4285f4",label:bmRuntime.i18n("cj_i18n_00010","Manage labels"),onClick:function(){bmRuntime.openTab("https://www.google.com/bookmarks/mark?op=editl&authuser="+g.account.authuser)}});return t.appendChild(l),t}function o(e){bmRuntime.openTab("https://www.google.com/bookmarks/find?authuser="+g.account.authuser+"&q="+e)}function r(){var e=cjBasics.urls.create("https://www.google.com/bookmarks/lookup",{start:"0",num:"1000000000",authuser:g.account.authuser});return cjBasics.ajax(e).then(function(e){function t(e){o[e]||(o[e]={label:e,newTabUrl:cjBasics.urls.create("https://www.google.com/bookmarks/lookup",{authuser:g.account.authuser,q:'label:"'+e+'"'})})}var a=e.split('id="search">')[1].split('<div style="text-align: center;"')[0],n=document.createElement("div");n.innerHTML=a;for(var l=n.querySelectorAll('div[id] > span[id*="bkmk_view_"]'),o={_bm_all:{label:bmRuntime.i18n("cj_i18n_00008","All bookmarks"),newTabUrl:"https://www.google.com/bookmarks/?authuser="+g.account.authuser}},r=[],c=0;c<l.length;c++){var i=l[c],m=i.querySelector('[id*="bkmk_info_"]'),s=m?m.textContent:"",u=["_bm_all"];if(m)for(var b=m.querySelectorAll("span > a"),d=0;d<b.length;d++)u.push(b[d].textContent);else u.push("blackMenuForGoogleUnlabeled");u.forEach(t),r.push({url:cjBasics.urls.getParameters(i.querySelector('[id*="bkmk_href_"]').href).q,title:i.querySelector('[id*="bkmk_href_"]').textContent,timestamp:parseFloat(i.querySelector("script").textContent.split("_tsRender(")[1].split(",")[0]),labels:u,labelsText:s})}o.blackMenuForGoogleUnlabeled={label:bmRuntime.i18n("cj_i18n_00369","Unlabeled"),newTabUrl:cjBasics.urls.create("https://www.google.com/bookmarks/lookup",{authuser:g.account.authuser,q:"label:^none"})};var p={bookmarks:r,labels:o};return g.cache.setItem("bm__cache__bookmarks__bookmarks",p),p})}function c(e){var t=cjMaterial.createElement("item");t.addEventListener("click",function(){bmRuntime.openTab(e.url)}),t.bookmarkLabels=e.labels;var a=cjMaterial.createElement("icon",{favicon:e.url});t.appendChild(a);var l=document.createElement("div");l.className="cj-md-item__body";var o=document.createElement("div");o.className="cj-md-item__header",o.textContent=e.title,l.appendChild(o);var r=document.createElement("div");r.className="cj-md-secondarytext";var c=[];if(e.labelsText&&c.push(e.labelsText),e.timestamp){var i=n(e.timestamp);c.push(bmRuntime.i18n("cj_i18n_00007","Added")+": "+i)}return r.textContent=c.join(" - "),l.appendChild(r),t.appendChild(l),t}function i(t,a){var n=t.bookmarks,l=t.labels;if(a||(u.tabs=bmElements.createElement("drawertabs",{items:l,selected:"_bm_all",onChange:function(e){b.textContent=l[e].label;for(var t=s.querySelectorAll(".cj-md-item"),a=0;a<t.length;a++){var n=t[a];n.classList.toggle("off-label",n.bookmarkLabels.indexOf(e)===-1)}}}),u.appendChild(u.tabs)),s.textContent="",0===n.length){var o=cjMaterial.createElement("emptystate",{color:"#4285f4",label:bmRuntime.i18n("cj_i18n_00370","No bookmarks found"),subLabel:bmRuntime.i18n("cj_i18n_00371","To add a bookmark, click the add button at the bottom"),iconName:"__mdi:star"});s.appendChild(o)}else n.forEach(function(e){var t=c(e);s.appendChild(t)});a||bmRuntime.toggleLoading("off",e)}function m(){bmRuntime.toggleLoading("on",e),u=cjMaterial.createElement("drawer",{color:"#4285f4"});var n=bmElements.createElement("servicelogo",{label:bmRuntime.i18n("cj_i18n_00190","Bookmarks"),color:"color"});u.appendChild(n);var c=bmElements.createElement("pageheader",{color:"#fff",pageId:"bookmarks",light:!0,searchboxProperties:{color:"#4285f4",onSubmit:o,submitInNewTab:!0}}),m=l(),b=cjMaterial.createElement("container",{scrollable:!0,shadow:!0});s=cjMaterial.createElement("list"),b.appendChild(s),e.appendChild(u),e.appendChild(c),d(c.searchbox.select),e.appendChild(m),e.appendChild(b),a().then(function(e){i(e,!0)}),r().then(i),t.setOpenInNewHandler(function(){var e=null,t=u.tabs.selected;"_bm_all"!==t&&(e="label:"+t),"blackMenuForGoogleUnlabeled"===t&&(e="label:^none");var a=cjBasics.urls.create("https://www.google.com/bookmarks/lookup",{authuser:g.account.authuser,q:e});bmRuntime.openTab(a)})}var s,u,b,d=t.onPageDisplay;m()}});