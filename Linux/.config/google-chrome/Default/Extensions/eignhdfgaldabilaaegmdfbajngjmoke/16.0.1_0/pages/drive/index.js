cjModules.define(function(){"use strict";return function(e,i){function o(){return"shared-with-me"===P?"shared-with-me":"recent"===P?"recent":"photos"===P?"photos":"trashed"===P?"trash":"starred"===P?"starred":"my-drive"===P?"my-drive":"folder"===P?"folders/"+D.id:"search"===P?"search?q="+encodeURIComponent(M.searchbox.value):""}function a(){if("shared-with-me"===P)return{q:"trashed = false and not 'me' in owners and sharedWithMe",orderBy:"sharedWithMeTime desc",spaces:"drive,photos"};if("recent"===P)return{q:"(not mimeType = 'application/vnd.google-apps.folder') and trashed = false",orderBy:"recency desc",spaces:"drive,photos"};if("photos"===P)return{q:"(not mimeType = 'application/vnd.google-apps.folder') and trashed = false and 'me' in owners",orderBy:"createdTime desc",spaces:"photos",hideLabels:!0,listview:!1};var e=G.selected;if("trashed"===P)return{q:"trashed = true and explicitlyTrashed = true",orderBy:"folder,"+e,spaces:"drive,photos"};if("starred"===P)return{q:"trashed = false and starred = true",orderBy:"folder,"+e,spaces:"drive,photos"};if("my-drive"===P)return{q:"trashed = false and 'root' in parents",orderBy:"folder,"+e,spaces:"drive,photos"};if("folder"===P)return{q:"trashed = false and '"+D.id+"' in parents",orderBy:"folder,"+e,spaces:"drive,photos",subHeaderColor:D.color};if("search"===P){var i=M.searchbox.value,o=["trashed = false"],a=i;if(i.indexOf("type:")!==-1){a="";var n=i.split("type:")[1];i.indexOf(" ")!==-1&&(a=i.split(" ")[1],n=n.split(" ")[0]);var t=ee[n];o.push(t)}return o.push("fullText contains '"+a+"'"),{q:o.join(" and "),spaces:"drive,photos"}}return null}function n(){x.textContent="";var i=a();K.then(function(){bmRuntime.toggleLoading("off",e);var o=cjgDoclist.create({subHeaderColor:i.subHeaderColor||O,listview:"boolean"==typeof i.listview?i.listview:z,onFileClick:m,searching:"search"===P,cachingId:"my-drive"===P||"recent"===P?"bm__cache__drive__doclist":null,spaces:i.spaces,orderBy:i.orderBy,hideLabels:i.hideLabels,q:i.q});o.classList.add("bm-ele--loading--blue"),x.appendChild(o)})}function t(i){for(var o=e.querySelectorAll("div:not(.bm-ele-fulldialog) > .cj-md-appbar"),a=cjColors.getContrastColor(cjColors.hexToRgb(i)),n=0;n<o.length;n++)o[n].style.backgroundColor=i,o[n].classList.toggle("cj-md--dark",a);var t=e.querySelector(".fab-placeholder");t.style.color="#fff"===i?O:i,t.classList.toggle("cj-md--dark",a)}function r(i,o){bmRuntime.toggleLoading("on",e);var a=ne[i];if(a&&a.page)return bmRuntime.changeToPage(a.page),void(N.selected=P);B=P,P=i,S=D,D=o,N.selected=i,"folder"!==P&&t(I),a?L.textContent=a.label:"folder"===P?(L.textContent="",c(D),t(D.color||I)):"search"===P&&(L.textContent="Search"),R.updateIcon({iconName:"search"===P?"__mdi:arrow_back":"__mdi:menu"});var r=V.indexOf(i)===-1;H.style.display=r?"none":"";var m="photos"===i;k.style.display=m?"none":"",n();var l="recent"===i;(l||"my-drive"===i)&&browserStorage.sync.setItem("prefDriveUseRecent",l)}function m(e){if("application/vnd.google-apps.folder"===e.mimeType){var i=e.folderColorRgb;"#8f8f8f"===i&&(i=null),r("folder",{id:e.id,color:i})}else{var o=e.webViewLink;cjBasics.urls.insertParameter(o,"authuser",g.account.authuser),bmRuntime.openTab(o)}}function c(e){var i=cjBasics.urls.create(W+"files/"+e.id,{fields:"name,parents"});g.request(i,{fetchAs:"json"},{scope:J}).then(function(i){var o=document.createElement("span");o.textContent=i.name;var a=L.querySelector("span");if(a){var n=document.createTextNode(" > ");o.addEventListener("click",function(){a.firstChild===o?r("my-drive"):r("folder",e)});var t=a.firstChild;a.insertBefore(n,t),a.insertBefore(o,n)}else a=document.createElement("span"),L.appendChild(a),a.appendChild(o);"parents"in i&&c({id:i.parents[0]})})}function l(){var e=cjMaterial.createElement("drawer",{color:O}),i=bmElements.createElement("servicelogo",{label:bmRuntime.i18n("cj_i18n_00390","Drive"),color:"color"});return e.appendChild(i),N=bmElements.createElement("drawertabs",{items:ne,onChange:r,selected:P}),e.appendChild(N),e}function p(){var e=document.createDocumentFragment();return ae.forEach(function(i){var o=cjMaterial.createElement("item");o.addEventListener("click",function(){M.searchmenu.hide();var e=M.searchbox.value;e.indexOf("type:")!==-1&&(e=e.split(" ")[1]),M.searchbox.value="type:"+i.value+(e?" "+e:""),"search"===P?n():r("search")});var a=cjMaterial.createElement("icon",{name:i.iconName,color:i.color});o.appendChild(a);var t=document.createElement("div");t.textContent=i.label,o.appendChild(t),e.appendChild(o)}),e}function d(e){var i=e,o=i.split("#");i=o[0];var a=o[1];i.indexOf("authuser")===-1&&(i+=i.indexOf("?")===-1?"?":"&",i+="authuser="+g.account.authuser),"folder"===P&&D&&(i+=i.indexOf("?")===-1?"?":"&",i+="folder="+D.id),a&&(i+="#"+a),bmRuntime.openTab(i)}function s(e){var i=document.createElement("div");return i.className="new-file-container bm-ele-shortcutlist bm-ele-shortcutlist--with-borders",i.addEventListener("click",function(){C.close()}),e.forEach(function(e){e.onClick||(e.onClick=function(){d(e.url)});var o=cjMaterial.createElement("item");if(e.id&&(o.dataset.id=e.id),e.onClick&&o.addEventListener("click",e.onClick),e.icon||e.iconName){var a=cjMaterial.createElement("icon",{serviceName:e.iconName||e.icon.name||"placeholder"});o.appendChild(a)}var n=document.createElement("div");n.className="cj-md-item__body",n.textContent=e.label,o.appendChild(n),i.appendChild(o)}),i}function u(){return g.request("https://www.googleapis.com/drive/v2/apps",{fetchAs:"json"},{internal:!0,scope:J}).then(function(e){var i=[];return e.items.filter(function(e){return e.supportsCreate&&Z.indexOf(e.id)===-1}).forEach(function(e){var o,a=e.name,n=e.createUrl+(e.createUrl.indexOf("?")!==-1?"&":"?")+"authuser="+g.account.authuser,t=cjBasics.isRetina?64:32;e.icons.forEach(function(e){e.size===t&&"application"===e.category&&(o=e.iconUrl)}),o||(o="images/"+t+"/undefined-"+t+".png"),i.push({label:a,url:n,icon:{url:o,size:32}})}),i}).then(function(e){return g.cache.setItem("bm__cache__drive__apps",e),e})}function h(){return g.cache.getItem("bm__cache__drive__apps").then(function(e){return Array.isArray(e)&&e.length>0?e:u()})}function f(){if(C)C.open();else{C=cjMaterial.createElement("bottomsheet");var i=cjMaterial.createElement("subheader",{label:bmRuntime.i18n("cj_i18n_00143","More")});C.appendChild(i);var o=s(te);C.appendChild(o),h().then(function(e){C.removeChild(o);var i=Array.isArray(e)?te.concat(e):te,a=s(i);C.appendChild(a)}),e.appendChild(C),setTimeout(C.open,100)}}function v(e){return new Promise(function(i,o){var a=new FileReader;a.readAsBinaryString(e),a.addEventListener("load",function(){i(a.result)}),a.addEventListener("error",function(){o()})})}function b(e){return v(e).then(function(i){var o=btoa(i),a=e.type||"application/octet-stream",n={name:e.name,mimeType:a},t=[X,"Content-Type: application/json\r\n\r\n",JSON.stringify(n),X,"Content-Type: ",a,"\r\n","Content-Transfer-Encoding: base64\r\n","\r\n",o,Y].join("");return g.request("https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart",{method:"POST",body:t,headers:{"Content-Type":'multipart/mixed; boundary="'+Q+'"'}},{scope:J})})}function _(){return bmElements.createElement("pageheader",{color:I,pageId:"drive",light:!0,searchboxProperties:{color:"#4285f4",onSubmit:function(){"search"!==P?r("search"):n()},onSubmitAlt:function(e){var i=cjBasics.urls.create(F+"search",{q:e});bmRuntime.openTab(i)}},includeSearchMenu:!0})}function y(e){var i,o=e.id,a=e.label,n=oe[o].color,t=oe[o].name;return i="function"==typeof ie[o]?ie[o]:function(){d(ie[o])},cjMaterial.createElement("fab",{mini:!0,label:a,color:n,iconName:t,onClick:i})}function T(e){var i=cjMaterial.createElement("appbar",{color:I,secondary:!0,light:!0});return R=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){"search"===P?(M.searchbox.value="",R.updateIcon({iconName:"__mdi:menu"}),r(B,S)):E.open()}}),i.appendChild(R),L=cjMaterial.createElement("title",{label:ne[P].label}),i.appendChild(L),G=bmElements.createElement("dropdown",{selected:e.prefDriveOrderBy||"name",onChange:function(e){n(),G.close(),browserStorage.sync.setItem("prefDriveOrderBy",e)},items:$}),H=cjMaterial.createElement("iconbutton",{label:bmRuntime.i18n("cj_i18n_00096","Order by"),iconName:"__mdi:cj_sort_by_alpha",onClick:function(){G.open()}}),i.appendChild(H),H.addEventListener("click",function(e){e.stopPropagation()}),i.appendChild(G),k=cjMaterial.createElement("iconbutton",{label:bmRuntime.i18n("cj_i18n_00106","Change view"),iconName:z?"__mdi:view_module":"__mdi:view_list",onClick:function(){z=!z,k.updateIcon({iconName:z?"__mdi:view_module":"__mdi:view_list"}),browserStorage.sync.setItem("prefDriveThumbnailView",!z),n()}}),i.appendChild(k),i}function w(){var i=document.createElement("input");return i.type="file",i.multiple=!0,i.style.display="none",i.addEventListener("change",function(){bmRuntime.toggleLoading("on",e);for(var o=[],a=0;a<i.files.length;a++)o.push(b(i.files[a]));Promise.all(o).then(function(){bmRuntime.toggleLoading("off",e)})}),i}function j(){bmRuntime.toggleLoading("on",e),q=w(),e.appendChild(q),M=_(),e.appendChild(M);var i=p();browserStorage.sync.get(["prefDriveThumbnailView","prefDriveUseRecent","prefDriveOrderBy"]).then(function(o){o.prefDriveUseRecent&&(P="recent"),z=!o.prefDriveThumbnailView,E=l(),e.appendChild(E);var a=T({prefDriveOrderBy:o.prefDriveOrderBy});e.appendChild(a);var t=document.createElement("div");t.className="fab-container";var r=[{id:"document",label:bmRuntime.i18n("cj_i18n_00145","Document")},{id:"spreadsheet",label:bmRuntime.i18n("cj_i18n_00146","Spreadsheet")},{id:"presentation",label:bmRuntime.i18n("cj_i18n_00147","Presentation")},{id:"upload",label:bmRuntime.i18n("cj_i18n_00148","Upload")}];r.forEach(function(e){var i=y(e);t.appendChild(i)});var m=cjMaterial.createElement("fab",{label:bmRuntime.i18n("cj_i18n_00091","More"),color:"#e5e5e5",iconName:"__mdi:add",onClick:f});m.classList.add("fab-overflow"),t.appendChild(m);var c=cjMaterial.createElement("fab",{color:O,label:bmRuntime.i18n("cj_i18n_00090","New file"),iconName:"__mdi:add",isPlaceholder:!0});c.classList.add("fab-placeholder"),t.appendChild(c),e.appendChild(t),x=cjMaterial.createElement("container",{shadow:!0}),M.searchmenu.appendChild(i);var p=cjMaterial.createElement("iconbutton",{iconName:"__mdi:arrow_drop_down",onClick:M.searchmenu.toggle});M.searchbox.appendChild(p),e.appendChild(x),U(M.searchbox.select),n()}),g.auth.getAccessToken(J)["catch"](function(i){var o=bmElements.createElement("fulldialog",{serviceLogo:{label:bmRuntime.i18n("cj_i18n_00390","Drive")},iconName:"drive",message:bmRuntime.i18n("cj_i18n_00089","Before you can use this page, you need to give the extension access to Google Drive"),actionLabel:bmRuntime.i18n("cj_i18n_00224","Give permission"),action:i.authorize});e.appendChild(o)})}var C,x,R,E,N,M,L,k,B,D,S,z,q,U=i.onPageDisplay,O="#4285f4",I="#fff",P="my-drive",A=Math.round(document.documentElement.offsetHeight*document.documentElement.offsetWidth/7500);A<20&&(A=20),e.classList.add("bm-ele--loading--blue");var F="https://drive.google.com/drive/u/"+g.account.authuser+"/";i.setOpenInNewHandler(function(){var e=F+o();bmRuntime.openTab(e)});var G,H,V=["trashed","starred","my-drive","folder"],W="https://www.googleapis.com/drive/v3/",J=["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.photos.readonly","https://www.googleapis.com/auth/drive.apps.readonly"],K=Promise.all([cjBasics.loadStyleFile("stylesheets/cjg-doclist.css"),cjBasics.loadScriptFile("scripts/cjg-doclist.js")]),Q="-------314159265358979323846",X="\r\n--"+Q+"\r\n",Y="\r\n--"+Q+"--",Z=["889782162350","619683526622","952342923413","196802322321","796396377186","1083656409722"],$=[{id:"name",label:bmRuntime.i18n("cj_i18n_00092","Name")},{id:"modifiedTime desc",label:bmRuntime.i18n("cj_i18n_00093","Last modified")},{id:"modifiedByMeTime desc",label:bmRuntime.i18n("cj_i18n_00094","Last modified by me")},{id:"viewedByMeTime desc",label:bmRuntime.i18n("cj_i18n_00095","Last opened by me")}],ee={archive:"(mimeType = 'application/bzip2' or mimeType = 'application/gzip' or mimeType = 'application/gzip-compressed' or mimeType = 'application/gzipped' or mimeType = 'application/rar' or mimeType = 'application/tar' or mimeType = 'application/x-bzip' or mimeType = 'application/x-bzip-compressed-tar' or mimeType = 'application/x-bzip2' or mimeType = 'application/x-gtar' or mimeType = 'application/x-gtar-compressed' or mimeType = 'application/x-gunzip' or mimeType = 'application/x-gzip' or mimeType = 'application/x-gzip-compressed' or mimeType = 'application/x-rar' or mimeType = 'application/x-tar' or mimeType = 'application/x-tgz' or mimeType = 'application/x-zip' or mimeType = 'application/x-zip-compressed' or mimeType = 'application/zip' or mimeType = 'gzip/document' or mimeType = 'multipart/x-gzip' or mimeType = 'multipart/x-rar' or mimeType = 'multipart/x-tar' or mimeType = 'multipart/x-zip' or mimeType = 'multipart/zip')",audio:"(mimeType = 'audio/3gp' or mimeType = 'audio/midi' or mimeType = 'audio/mp4a-latm' or mimeType = 'audio/mpeg' or mimeType = 'audio/mpeg3' or mimeType = 'audio/ogg' or mimeType = 'audio/x-ms-wma' or mimeType = 'audio/x-wav' or mimeType = 'audio/wav')",document:"(mimeType = 'application/msword' or mimeType = 'application/vnd.google-apps.document' or mimeType = 'application/vnd.google-apps.kix' or mimeType = 'application/vnd.ms-word' or mimeType = 'application/vnd.oasis.opendocument.text' or mimeType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' or mimeType = 'text/plain')",drawing:"(mimeType = 'application/vnd.oasis.opendocument.graphics' or mimeType = 'image/vnd.adobe.photoshop' or mimeType = 'image/x-photoshop' or mimeType = 'application/illustrator' or mimeType = 'application/vnd.google-apps.drawing')",folder:"(mimeType = 'application/vnd.google-apps.folder')",form:"(mimeType = 'application/vnd.google-apps.form' or mimeType = 'application/vnd.google-apps.freebird')",image:"(mimeType = 'image/jpeg' or mimeType = 'image/png' or mimeType = 'image/gif' or mimeType = 'image/tiff' or mimeType = 'image/x-ms-bmp' or mimeType = 'image/svg+xml' or mimeType = 'image/vnd.microsoft.icon')",pdf:"(mimeType = 'application/pdf')",presentation:"(mimeType = 'application/mspowerpoint' or mimeType = 'application/vnd.ms-powerpoint' or mimeType = 'application/vnd.oasis.opendocument.presentation' or mimeType = 'application/vnd.openxmlformats-officedocument.presentationml.presentation' or mimeType = 'application/vnd.google-apps.presentation' or mimeType = 'application/vnd.google-apps.punch')",spreadsheet:"(mimeType = 'application/msexcel' or mimeType = 'application/vnd.google-apps.form' or mimeType = 'application/vnd.google-apps.freebird' or mimeType = 'application/vnd.google-apps.ritz' or mimeType = 'application/vnd.google-apps.spreadsheet' or mimeType = 'application/vnd.ms-excel' or mimeType = 'application/vnd.oasis.opendocument.spreadsheet' or mimeType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')",video:"(mimeType = 'video/3gpp' or mimeType = 'video/avi' or mimeType = 'video/dv' or mimeType = 'video/flv' or mimeType = 'video/mp2p' or mimeType = 'video/mp2t' or mimeType = 'video/mp4' or mimeType = 'video/mpeg' or mimeType = 'video/mpv' or mimeType = 'video/ogg' or mimeType = 'video/quicktime' or mimeType = 'video/x-flv' or mimeType = 'video/x-msvideo' or mimeType = 'video/x-ms-wmv' or mimeType = 'video/x-m4v' or mimeType = 'video/x-ms-asf' or mimeType = 'video/x-matroska' or mimeType = 'video/x-dv' or mimeType = 'video/webm')"},ie={upload:function(){q.click()},document:"https://docs.google.com/document/create?authuser="+g.account.authuser,spreadsheet:"https://docs.google.com/spreadsheets/create?authuser="+g.account.authuser,presentation:"https://docs.google.com/presentation/create?authuser="+g.account.authuser,drawing:"https://docs.google.com/drawings/create?authuser="+g.account.authuser,form:"https://docs.google.com/forms/create?authuser="+g.account.authuser,script:"https://script.google.com/create?authuser="+g.account.authuser,table:"https://www.google.com/fusiontables/DataSource?dsrcid=implicit&authuser="+g.account.authuser,map:"https://www.google.com/maps/d/u/"+g.account.authuser+"/drive?state=%7B%22action%22%3A%22create%22%7D"},oe={document:{name:"__mdi:drive_document",color:"#4285f4"},spreadsheet:{name:"__mdi:drive_spreadsheet",color:"#34a853"},presentation:{name:"__mdi:drive_presentation",color:"#ffcd40"},upload:{name:"__mdi:file_upload",color:"#b3b3b3"}},ae=[{iconName:"__mdi:drive_pdf",color:"#ea4335",value:"pdf",label:bmRuntime.i18n("cj_i18n_00137","PDFs")},{iconName:"__mdi:drive_document",color:"#4285f4",value:"document",label:bmRuntime.i18n("cj_i18n_00138","Text documents")},{iconName:"__mdi:drive_spreadsheet",color:"#34a853",value:"spreadsheet",label:bmRuntime.i18n("cj_i18n_00139","Spreadsheets")},{iconName:"__mdi:drive_presentation",color:"#FFCD40",value:"presentation",label:bmRuntime.i18n("cj_i18n_00140","Presentations")},{iconName:"__mdi:drive_image",color:"#ea4335",value:"image",label:bmRuntime.i18n("cj_i18n_00141","Photos & images")},{iconName:"__mdi:drive_video",color:"#ea4335",value:"video",label:bmRuntime.i18n("cj_i18n_00142","Videos")}],ne={"my-drive":{label:bmRuntime.i18n("cj_i18n_00001","My Drive"),iconName:"__mdi:cj_my_drive",newTabUrl:F+"my-drive"},"shared-with-me":{label:bmRuntime.i18n("cj_i18n_00002","Shared with me"),iconName:"__mdi:people",newTabUrl:F+"shared-with-me"},photos:{label:bmRuntime.i18n("cj_i18n_00088","Google Photos"),iconName:"__mdi:photos",newTabUrl:F+"photos"},recent:{label:bmRuntime.i18n("cj_i18n_00003","Recent"),iconName:"__mdi:schedule",newTabUrl:F+"recent"},starred:{label:bmRuntime.i18n("cj_i18n_00004","Starred"),iconName:"__mdi:star",newTabUrl:F+"starred"},trashed:{label:bmRuntime.i18n("cj_i18n_00005","Trash"),iconName:"__mdi:delete",newTabUrl:F+"trash",divider:!0},docs:{label:bmRuntime.i18n("cj_i18n_00391","Docs"),iconName:"__mdi:drive_document",color:"#4285f4",colorIcon:!0,newTabUrl:"https://docs.google.com/document/u/"+g.account.authuser+"/",page:"docs"},sheets:{label:bmRuntime.i18n("cj_i18n_00393","Sheets"),iconName:"__mdi:drive_spreadsheet",color:"#34a853",colorIcon:!0,newTabUrl:"https://docs.google.com/spreadsheets/u/"+g.account.authuser+"/",page:"sheets"},slides:{label:bmRuntime.i18n("cj_i18n_00407","Slides"),iconName:"__mdi:drive_presentation",color:"#ffcd40",colorIcon:!0,newTabUrl:"https://docs.google.com/presentation/u/"+g.account.authuser+"/",page:"slides"},forms:{label:bmRuntime.i18n("cj_i18n_00408","Forms"),iconName:"__mdi:drive_form",color:"#673ab7",colorIcon:!0,newTabUrl:"https://docs.google.com/forms/u/"+g.account.authuser+"/",page:"forms",divider:!0},storage:{label:bmRuntime.i18n("cj_i18n_00077","Upgrade storage"),iconName:"__mdi:storage",onClick:function(){bmRuntime.openTab("https://www.google.com/settings/storage?authuser="+g.account.authuser)}}},te=[{label:"Google "+bmRuntime.i18n("cj_i18n_00409","Drawings"),url:ie.drawing,iconName:"drawings"},{label:"Google "+bmRuntime.i18n("cj_i18n_00408","Forms"),url:ie.form,iconName:"forms"},{label:"Google "+bmRuntime.i18n("cj_i18n_00446","Fusion Tables"),url:ie.table,iconName:"fusion_tables"},{label:"Google "+bmRuntime.i18n("cj_i18n_00447","Apps Script"),url:ie.script,iconName:"script"},{label:"Google "+bmRuntime.i18n("cj_i18n_00410","My Maps"),url:ie.map,iconName:"my_maps"}];j()}});