cjModules.define(function(){"use strict";return function(e,t){function a(e){var t=cjBasics.urls.create(p+"search",{from:"[]",hl:g.lang,q:JSON.stringify(e.split(" "))});bmRuntime.openTab(t)}function n(e){var t=e||{},a={authuser:g.account.authuser,hl:g.lang};"undefined"!=typeof t.number?(a.hip=t.number,a.hpn=t.number):a.hip="";var n="https://plus.google.com/hangouts/_/",r=cjBasics.urls.create(n,a);bmRuntime.openTab(r)}function r(){return cjBasics.ajax(h+"request/user?hl="+g.lang,{fetchAs:"json"}).then(function(e){var t=e&&e.formattedCredit;if(t)return t;throw Error()},function(){throw Error()})}function i(){return cjBasics.ajax(h+"inbox/recent/all/?hl="+g.lang,{fetchAs:"xml"}).then(function(e){if(!e)throw Error();var t=e.querySelector("json");if(!t)throw Error();var a=t.textContent;if(!a)throw Error();var n=a.replace("<![CDATA[","").replace("]]>","");if(!n)throw Error();var r;try{r=JSON.parse(n)}catch(i){throw Error(i)}var l=r&&r.messages;if(!l)throw Error();return l},function(){throw Error()})}function l(e){return 2===e?b.voicemail:10===e||11===e?b.sms:0===e?b.missed:1===e||9===e?b.received:b.placed}function c(){var e=cjMaterial.createElement("container",{scrollable:!0,shadow:!0,darker:!0});return bmRuntime.toggleLoading("on",e),i().then(function(t){Object.keys(t).forEach(function(a){var r=t[a];if(!r.isTrash&&!r.isSpam){var i=cjMaterial.createElement("card",{withPadding:!0}),c=cjMaterial.createElement("title",{label:r.displayNumber});i.appendChild(c);var o=l(r.type),d=cjMaterial.createElement("icon",o);d.classList.add("call-icon"),i.appendChild(d);var s=document.createElement("p");s.textContent=r.displayStartDateTime,i.appendChild(s);var m=cjMaterial.createElement("secondarytext",{label:r.relativeStartTime});i.appendChild(m);var u=cjMaterial.createElement("button",{label:bmRuntime.i18n("cj_i18n_00213","Call")});u.classList.add("call-button"),u.addEventListener("click",function(){n({number:r.phoneNumber})}),i.appendChild(u),e.appendChild(i)}})},function(){var t=cjMaterial.createElement("emptystate",{color:"#4285f4",label:bmRuntime.i18n("cj_i18n_00394","No recent calls"),iconName:"__mdi:call"});e.appendChild(t)}).then(function(){bmRuntime.toggleLoading("off",e)}),e}function o(){var e=cjMaterial.createElement("container",{scrollable:!0,shadow:!0,darker:!0});return bmRuntime.toggleLoading("on",e),r().then(function(t){var a=cjMaterial.createElement("card",{withPadding:!0}),n=cjMaterial.createElement("title",{label:"Credit: "});a.appendChild(n);var r=document.createElement("span");r.className="credits",r.textContent=t,n.appendChild(r);var i=cjMaterial.createElement("button",{label:bmRuntime.i18n("cj_i18n_00395","Add credits")});i.addEventListener("click",function(){bmRuntime.openTab(h+"#billing")}),a.appendChild(i),e.appendChild(a),bmRuntime.toggleLoading("off",e)},function(){var t=cjMaterial.createElement("card",{withPadding:!0});t.textContent=bmRuntime.i18n("cj_i18n_00396","Couldn't fetch your google voice credits. Are you use google voice is enabled for your account?"),e.appendChild(t),bmRuntime.toggleLoading("off",e)}),e}function d(){m={callHistory:{label:bmRuntime.i18n("cj_i18n_00397","Call history"),content:c},credits:{label:bmRuntime.i18n("cj_i18n_00398","Credits"),content:o}};var n=bmElements.createElement("pageheader",{color:"#fff",light:!0,pageId:"voice",searchboxProperties:{color:"#4285f4",onSubmit:a,submitInNewTab:!0}});e.appendChild(n),u(n.searchbox.select);var r=cjMaterial.createElement("appbar",{color:"#fff",light:!0,secondary:!0}),i=cjMaterial.createElement("tabs",{color:"#4285f4",fill:!0,items:m,onChange:function(e){s.selected=e},selected:f});r.appendChild(i),e.appendChild(r),s=bmElements.createElement("multiplecontainer",{items:m,selected:f}),e.appendChild(s),t.setOpenInNewHandler(function(){var e=p+"calls";"credits"===s.selected&&(e=h+"#billing"),bmRuntime.openTab(e)})}var s,m,u=t.onPageDisplay,p="https://voice.google.com/u/"+g.account.authuser+"/",h="https://www.google.com/voice/b/"+g.account.authuser+"/",f="callHistory",b={voicemail:{name:"__mdi:voicemail"},sms:{name:"__mdi:textsms"},missed:{name:"__mdi:call_missed",color:"#ea4335"},received:{name:"__mdi:call_received",color:"#34a853"},placed:{name:"__mdi:call_made",color:"#4285f4"}};d()}});