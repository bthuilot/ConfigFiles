cjModules.define(function(){"use strict";return function(e,n){function t(e){for(var n=bmElements.createElement("maintoolbarbuttons","gplus"),t=0;t<bmRuntime.getMainToolbarButtonCount();t++)n.children[t].classList.add("hide-initially");e.appendChild(n)}function i(){e.classList.add("search"),O.searchbox.focus()}function a(e,n){cjgModules.load("plusone").then(function(){gapi.plusone.render(e,{width:336,bm_contentscript:"gplus_plusone",annotation:"inline",href:n,hl:g.lang})})}function o(e){var n=cjMaterial.createElement("card",{withPadding:!0});n.classList.add("plusone-card");var t=document.createElement("div");t.className="plusone-title";var i;i=e.favicon?cjMaterial.createElement("icon",{url:e.favicon}):cjMaterial.createElement("icon",{favicon:e.url}),t.appendChild(i);var o=document.createElement("h3");o.textContent=e.label,t.appendChild(o),n.appendChild(t);var c=document.createElement("div");return n.appendChild(c),a(c,e.url),n}function c(e){var n=k;n.textContent="";var t=cjMaterial.createElement("emptystate",{color:B,iconName:"__mdi:share",label:"Can't share page",subLabel:e});n.appendChild(t)}function r(e){return cjBasics.urls.create(J+"_/notifications/mobile",{hl:g.lang,bm_contentscript:"gplus_sharebox",url:e})}function l(e){N.selected="sharebox",N.pages.sharebox.iframe.src=r(e)}function s(e,n){cjgModules.load("comments").then(function(){gapi.comments.render(e,{href:n.url,width:384,first_party_property:"BLOGGER",view_type:"FILTERED_POSTMOD",bm_contentscript:"gplus_comments",authuser:g.account.authuser,pageId:g.account.pageid,hl:g.lang})})}function m(e){var n=k,t=o(e);n.appendChild(t);var i=cjMaterial.createElement("subheader",{label:bmRuntime.i18n("cj_i18n_00325","Loading...")});n.appendChild(i);var a=cjMaterial.createElement("card");a.classList.add("comments-card");var c=document.createElement("div");a.appendChild(c),n.appendChild(a),s(c,e),window.addEventListener("message",function(){var e=event.data.blackMenuShareAction;"undefined"!=typeof e&&l(e);var t=event.data.blackMenuGplusCommentsCount;if("undefined"!=typeof t){var o="";0===t?(o=bmRuntime.i18n("cj_i18n_00326","Nobody shared this page yet"),n.removeChild(a)):(o=t,o=1===t?t+" "+bmRuntime.i18n("",bmRuntime.i18n("cj_i18n_00328","others shared this page")):bmRuntime.i18n("cj_i18n_00327","One other shared this page"),a.classList.add("on")),i.textContent=o}},!1)}function d(){var e=cjMaterial.createElement("container",{darker:!0}),n=cjMaterial.createElement("appbar",{color:"#fff",light:!0,secondary:!0}),a=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){y.open()}});n.appendChild(a);var o=cjMaterial.createElement("title",{label:bmRuntime.i18n("cj_i18n_00297","Share this page")});n.appendChild(o);var r=cjMaterial.createElement("iconbutton",{iconName:"__mdi:search",onClick:i});r.classList.add("hide-initially"),n.appendChild(r),t(n),e.appendChild(n);var l=cjMaterial.createElement("fab",{label:bmRuntime.i18n("cj_i18n_00329","New post"),iconName:"__mdi:create",onClick:function(){N.selected="sharebox",N.pages.sharebox.iframe.reload()}});return e.appendChild(l),k=cjMaterial.createElement("container",{scrollable:!0,shadow:!0}),e.appendChild(k),browser.tabs.query({currentWindow:!0,active:!0}).then(function(e){var n=e[0],t=n.url;if(t){if(t.indexOf("http://")!==-1||t.indexOf("https://")!==-1)return void m(n);c(bmRuntime.i18n("cj_i18n_00330","You can only share normal webpages"))}}),e}function u(e){bmRuntime.openTab(J+"s/"+e)}function p(e){z!==e&&(z=e,W.then(function(){z===e&&L.sendMessage({method:"clickEle",parameters:{selector:Q[e].navigationItemSelector}})}))}function b(n){A?e.classList.remove("search"):A=!0;var t=F.indexOf(n)!==-1,i=Q[n];t?(N.selected="website",p(n),S.textContent=i.label):N.selected=n}function h(){var e=cjMaterial.createElement("drawer",{color:B}),n=bmElements.createElement("servicelogo",{label:"+",color:"color"});return e.appendChild(n),x=bmElements.createElement("drawertabs",{items:Q,onChange:b,selected:q}),e.appendChild(x),e}function f(){var e="gplus-"+Date.now();bmRuntime.onRequestReceived(e).then(function(e){bmRuntime.openTab(e.split("?")[0])}),L.sendMessage({requestId:e,method:"getUrl"})}function v(){return cjBasics.ajax(Y+"up/").then(function(e){return e.indexOf("up/accounts/upgrade")!==-1?"disabled":e.indexOf("<title>Google</title>")!==-1?"disabledAdministrator":"enabled"})}function _(){var e="";if(!x)return e;var n=x.selected;if(F.indexOf(n)===-1)return e;var t=Q[n].websitePath;return"string"==typeof t?t:e}function j(){return cjBasics.urls.create(J+_(),{bm_contentscript:"gplus_webapp",bm_embed:"1",bm_wiz:"1",hl:g.lang})}function C(){var e=document.createDocumentFragment(),n=document.createElement("div");n.className="cj-md-subheader",n.textContent="Type",e.appendChild(n);var t=[{label:bmRuntime.i18n("cj_i18n_00331","Everything"),value:"/top"},{label:bmRuntime.i18n("cj_i18n_00926","Discover"),value:"/discover"},{label:bmRuntime.i18n("cj_i18n_00293","Communities"),value:"/communities"},{label:bmRuntime.i18n("cj_i18n_00334","People and pages"),value:"/people"}];return t.forEach(function(n){var t=cjMaterial.createElement("item");t.textContent=n.label,t.addEventListener("click",function(){var e=O.searchbox.value;e.length>0&&bmRuntime.openTab(J+"s/"+e+n.value)}),e.appendChild(t)}),e}function E(){var e=cjMaterial.createElement("container"),n=cjMaterial.createElement("appbar",{secondary:!0});T=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){P?L.sendMessage({method:"back"}):y.open()}}),n.appendChild(T),S=cjMaterial.createElement("title",{label:bmRuntime.i18n("cj_i18n_00291","Home")}),n.appendChild(S);var a=cjMaterial.createElement("iconbutton",{iconName:"__mdi:search",onClick:i});return a.classList.add("hide-initially"),n.appendChild(a),t(n),e.appendChild(n),L=bmElements.createElement("iframe",{darker:!0,src:j(),noLoading:!0}),e.appendChild(L),e}function w(){var e=cjMaterial.createElement("container"),n=cjMaterial.createElement("appbar",{secondary:!0,light:!0}),t=cjMaterial.createElement("iconbutton",{iconName:"__mdi:arrow_back",onClick:function(){N.selected="comments"}});n.appendChild(t);var i=cjMaterial.createElement("title",{label:bmRuntime.i18n("cj_i18n_00329","New post")});return n.appendChild(i),e.appendChild(n),e.iframe=bmElements.createElement("iframe",{src:r()}),e.appendChild(e.iframe),e}function R(n){for(var t=e.querySelectorAll("div:not(.bm-ele-fulldialog) > .cj-md-appbar"),i=0;i<t.length;i++){var a=t[i];a.setAttribute("style","background-color: "+n),a.classList.toggle("cj-md--dark",!n.startsWith("#fff"))}}function M(){n.setOpenInNewHandler(function(){"website"===N.selected?f():bmRuntime.openTab(J)}),K={comments:{color:"#fff",content:d},website:{color:"#fff",content:E,loadOnInit:!0},sharebox:{color:"#fff",content:w}};var t=0;N=bmElements.createElement("multiplecontainer",{items:K,selected:G,onChange:function(n){R(K[n].color),t++,t>2&&e.classList.remove("search")}}),e.classList.add("search"),v().then(function(n){if("enabled"!==n){var t,i,a;"disabled"===n&&(t=bmRuntime.i18n("cj_i18n_00335","The current account isn't yet signed up to Google+"),i=bmRuntime.i18n("cj_i18n_00337","Sign up"),a=function(){bmRuntime.openTab("https://plus.google.com/u/"+g.account.authuser+"/up/")}),"disabledAdministrator"===n&&(t=bmRuntime.i18n("cj_i18n_00336","Google+ is not available for your organization. Please contact your administrator to enable this service for at least one user in the organization."),i=bmRuntime.i18n("cj_i18n_00234","Change account"),a=function(){setTimeout(function(){document.querySelector(".account-switcher>.account-item").click()})}),e.textContent="";var o=bmElements.createElement("fulldialog",{serviceLogo:{label:"+"},iconName:"gplus",message:t,actionLabel:i,action:a});e.appendChild(o)}}),browser.runtime.onMessage.addListener(function(e){e.closeSharebox&&(N.selected=x.selected)}),O=bmElements.createElement("pageheader",{color:"#fff",light:!0,pageId:"gplus",searchboxProperties:{color:B,onSubmit:u,onClear:function(){e.classList.remove("search"),O.searchmenu.hide()},submitInNewTab:!0},includeSearchMenu:!0}),O.classList.add("gplus-top-appbar");var i=C();O.searchmenu.appendChild(i),y=h(),e.appendChild(O),D(O.searchbox.select),e.appendChild(N),e.appendChild(y),b(q);var a;window.addEventListener("message",function(e){var n=e.data;if(n&&"gplusWebsiteData"!==!n.method&&("view"===n.key&&H===!1&&(H=!0,I()),"website"===N.selected)){if("title"===n.key)return void("back"===a&&(S.textContent=n.value));if("view"===n.key)return a=n.value,x.selected=a,P="back"===a,void T.updateIcon({iconName:P?"__mdi:arrow_back":"__mdi:menu"});if("color"===n.key){var t=n.value;return K.website.color=t,void R(t)}}})}var y,x,N,k,L,S,T,P,I,O,D=n.onPageDisplay,U="popup"===bmRuntime.environment,G=U?"comments":"website",q=U?"comments":"stream",A=!1,B="#ea4335",z="stream",H=!1,W=new Promise(function(e){I=e}),F=["stream","communities","discover","profile","people","notifications","settings"],Y="https://plus.google.com/u/"+g.account.authuser+"/",J=Y;g.account.pageid&&"none"!==g.account.pageid&&(J+="b/"+g.account.pageid+"/");var K,Q={stream:{label:bmRuntime.i18n("cj_i18n_00291","Home"),iconName:"__mdi:home",navigationItemSelector:"[role='navigation'] [href='./'], [role='dialog'] [href='./']",websitePath:"",newTabUrl:J+"stream"},discover:{color:"#311b92",label:bmRuntime.i18n("cj_i18n_00926","Discover"),iconName:"__mdi:explore",navigationItemSelector:"[href='./discover']",websitePath:"discover",newTabUrl:J+"discover"},communities:{color:"#0f9d58",label:bmRuntime.i18n("cj_i18n_00293","Communities"),iconName:"__mdi:communities",navigationItemSelector:"[href='./communities']",websitePath:"communities",newTabUrl:J+"communities"},profile:{color:"#4285f4",label:bmRuntime.i18n("cj_i18n_00294","Profile"),navigationItemSelector:"[role='navigation'] [href^='./"+g.account.userid+"'], [role='dialog'] [href^='./"+g.account.userid+"']",websitePath:g.account.userid,iconName:"__mdi:account_circle",newTabUrl:J+"me"},people:{color:"#4285f4",label:bmRuntime.i18n("cj_i18n_00295","People"),navigationItemSelector:"[role='navigation'] [href^='./circles'], [role='navigation'] [href^='./people'], [role='dialog'] [href^='./circles'], [role='dialog'] [href^='./people']",websitePath:"people",iconName:"__mdi:people",newTabUrl:J+"people"},notifications:{label:bmRuntime.i18n("cj_i18n_00296","Notifications"),navigationItemSelector:"[role='navigation'] [href^='./notifications/all'], [role='dialog'] [href^='./notifications/all']",websitePath:"notifications/all",iconName:"__mdi:notifications",newTabUrl:J+"notifications/all"},comments:{label:bmRuntime.i18n("cj_i18n_00297","Share this page"),iconName:"__mdi:share",divider:!0},settings:{color:"#4285f4",label:bmRuntime.i18n("cj_i18n_00298","Settings"),navigationItemSelector:"[role='navigation'] [href^='./settings'], [role='dialog'] [href^='./settings']",websitePath:"settings",iconName:"__mdi:settings",newTabUrl:J+"settings"}};U||delete Q.comments,M()}});