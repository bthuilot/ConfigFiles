cjModules.define(function(){"use strict";return function(e,t){function n(){var e=cjMaterial.createElement("drawer",{color:"#4285f4"}),t=bmElements.createElement("servicelogo",{label:bmRuntime.i18n("cj_i18n_00418","Groups"),color:"color"});return e.appendChild(t),e.tabs=bmElements.createElement("drawertabs",{items:v,onChange:function(e){var t=v[e];t.external===!0&&bmRuntime.openTab(t.newTabUrl),x.textContent="",y.textContent=t.label,t.init()},selected:"my"}),e.appendChild(e.tabs),e}function r(e){e&&bmRuntime.openTab(E+"#!search/"+e)}function o(){var e=cjMaterial.createElement("appbar",{color:"#4285f4",secondary:!0}),t=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){C.open()}});return e.appendChild(t),y=cjMaterial.createElement("title",{label:bmRuntime.i18n("cj_i18n_00388","My groups")}),e.appendChild(y),e}function a(e){var t,n,r=JSON.parse(e.replace(/\\/g,"").replace(/'/g,'"').replace("//OK",""));for(n=r.length-1;n>-1;n--)if(Array.isArray(r[n])){t=r[n];break}var o=[];for(n=0;n<t.length;n++)t[n].indexOf("@googlegroups.com")!==-1&&o.push({id:t[n].split("@googlegroups.com")[0],name:t[n-1]});return o}function i(e,t){var n=cjBasics.urls.create("https://groups.google.com/forum/tree",{appversion:"1",hl:"en",authuser:g.account.authuser});return cjBasics.ajax(n,{method:"POST",body:"7|3|6|https://groups.google.com/forum/|"+t+"|4w|"+e+"|_|getNavTreeContents|1|2|3|4|5|6|0|",headers:{"content-type":"text/x-gwt-rpc; charset=UTF-8","x-gwt-module-base":"","x-gwt-permutation":""}}).then(function(e){return e.startsWith("//OK")?e:Promise.reject()})}function c(e,t){var n=e.xrsfToken,r=e.strongNames,o=t||0;return r.length===o?Promise.reject():i(n,r[o])["catch"](function(){return c(e,o+1)})}function u(){return w().then(c).then(a)}function m(e,t){var n="https://groups.google.com/forum/rel_content?appversion=1&hl=en&authuser="+g.account.authuser;return cjBasics.ajax(n,{method:"POST",body:"7|3|6|https://groups.google.com/forum/|"+t+"|5i|"+e+"|_|getForumsAndDomains|1|2|3|4|5|6|0|",headers:{"content-type":"text/x-gwt-rpc; charset=UTF-8","x-gwt-module-base":"","x-gwt-permutation":""}}).then(function(e){return e.startsWith("//OK")?e:Promise.reject()})}function l(e,t){var n=e.xrsfToken,r=e.strongNames,o=t||0;return r.length===o?Promise.reject():m(n,r[o])["catch"](function(){return l(e,o+1)})}function s(){return w().then(l).then(a).then(function(e){return g.cache.setItem("bm__cache__groups__groups",e),e})}function d(){return g.cache.getItem("bm__cache__groups__groups").then(function(e){return Array.isArray(e)?e:[]})}function p(e){var t=cjMaterial.createElement("item");t.addEventListener("click",function(){bmRuntime.openTab(E+"#!forum/"+e.id)});var n=cjMaterial.createElement("icon",{name:"__mdi:forum",color:"#4285f4"});t.appendChild(n);var r=document.createElement("div");r.className="cj-md-item__body",t.appendChild(r);var o=document.createElement("div");o.className="cj-md-item__header",o.textContent=e.name,r.appendChild(o);var a=document.createElement("div");return a.className="cj-md-secondarytext",a.textContent=e.id,r.appendChild(a),t}function f(t,n){if(x.textContent="",Array.isArray(t)&&t.length>0)t.forEach(function(e){var t=p(e);x.appendChild(t)});else{var r=bmRuntime.i18n("cj_i18n_00386","No groups found");"recent"===n&&(r=bmRuntime.i18n("cj_i18n_00387","No recent groups found"));var o=cjMaterial.createElement("emptystate",{color:"#4285f4",label:r,subLabel:bmRuntime.i18n("cj_i18n_00383","To add a new group, click the add button"),iconName:"__mdi:forum"});x.appendChild(o)}"cache"!==n&&bmRuntime.toggleLoading("off",e)}function h(){x.textContent="";var e=cjMaterial.createElement("emptystate",{color:"#4285f4",label:bmRuntime.i18n("cj_i18n_00384","Couldn't load your groups"),subLabel:bmRuntime.i18n("cj_i18n_00385","If you think this is an error, please report it to the developer of the extension"),iconName:"__mdi:forum"});x.appendChild(e)}function b(t){return bmRuntime.toggleLoading("on",e),(t?d:s)().then(function(e){f(e,t&&"cache")},h)}function _(){bmRuntime.toggleLoading("on",e),u().then(function(e){f(e,"recent")},h)}function j(){bmRuntime.toggleLoading("on",e),v={my:{label:bmRuntime.i18n("cj_i18n_00388","My groups"),iconName:"__mdi:forum",init:function(){b(!0).then(function(){bmRuntime.toggleLoading("off",e)})},newTabUrl:E+"#!myforums"},recent:{label:bmRuntime.i18n("cj_i18n_00389","Recently viewed"),iconName:"__mdi:history",init:_},starred:{label:bmRuntime.i18n("cj_i18n_00004","Starred"),iconName:"__mdi:star",newTabUrl:E+"#!starred",external:!0},settings:{label:bmRuntime.i18n("cj_i18n_00298","Settings"),iconName:"__mdi:settings",newTabUrl:E+"#!usersettings/general",external:!0}},C=n();var t=bmElements.createElement("pageheader",{color:"#4285f4",pageId:"groups",searchboxProperties:{onSubmit:r,submitInNewTab:!0}}),a=o(),i=cjMaterial.createElement("fab",{label:bmRuntime.i18n("cj_i18n_00392","Create new group"),iconName:"__mdi:add",onClick:function(){bmRuntime.openTab(E+"#!creategroup")}});e.appendChild(i),x=cjMaterial.createElement("container",{scrollable:!0,shadow:!0}),e.appendChild(t),R(t.searchbox.select),e.appendChild(a),e.appendChild(x),e.appendChild(C),b(!0),b()}var v,x,C,y,R=t.onPageDisplay,E="https://groups.google.com/forum/?authuser="+g.account.authuser,w=function(){function e(){return cjBasics.ajax(E).then(function(e){return{xrsfToken:e.split('xsrf-token":"')[1].split('"')[0],gwtPermutation:e.split('src="/forum/')[1].split(".")[0]}})}function t(e){var t="https://groups.google.com/forum/"+e+".cache.js";return cjBasics.ajax(t).then(function(e){return e.split(/\(\);[a-zA-Z]{1,4}\.call\(this,[a-zA-Z]{1,4}\(\),'([0-9a-zA-Z]{32})/).filter(function(e,t){return t%2})})}var n;return function(){return n||(n=e().then(function(e){return t(e.gwtPermutation).then(function(t){return{xrsfToken:e.xrsfToken,strongNames:t}})})),n}}();j()}});