cjModules.define(function(){"use strict";return function(e){return function(i,n){function t(e){var i=e.webViewLink;i=cjBasics.urls.insertParameter(i,"authuser",g.account.authuser,!1),bmRuntime.openTab(i)}function a(){m.textContent="";var n=["trashed = false",v];T[f]&&n.push(T[f]),b&&(h=s.value,n.push("name contains '"+h+"'")),R.then(function(){bmRuntime.toggleLoading("off",i);var a=cjgDoclist.create({listview:j,onFileClick:t,entityName:e.entityName,emptyStateIcon:e.emptyStateIcon,primaryColor:e.primaryColor,searching:b,cachingId:b?null:"bm__cache__"+C+"__doclist",spaces:"drive",orderBy:N[y],q:n.join(" and ")});m.appendChild(a)})}function o(i){b=i,d.textContent=i?"Search":e.serviceName,p.updateIcon({iconName:i?"__mdi:arrow_back":"__mdi:menu"}),i===!1&&(s.value=""),a()}function c(){var i=cjMaterial.createElement("appbar",{secondary:!0,color:e.primaryColor,light:e.lightTheme});p=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){b?o(!1):u.open()}}),i.appendChild(p),d=cjMaterial.createElement("title",{label:e.serviceName}),i.appendChild(d);var n=bmElements.createElement("dropdown",{selected:f,onChange:function(e){f=e,browserStorage.sync.setItem(w+"FilterBy",e),a(),n.close()},items:[{id:"all",label:bmRuntime.i18n("cj_i18n_00107","All")},{id:"owned",label:bmRuntime.i18n("cj_i18n_00108","Owned by me")},{id:"shared",label:bmRuntime.i18n("cj_i18n_00109","Shared with me")}]}),t=cjMaterial.createElement("iconbutton",{label:bmRuntime.i18n("cj_i18n_00110","Filter"),iconName:"__mdi:filter_list",onClick:function(){n.open()}});i.appendChild(t),t.addEventListener("click",function(e){e.stopPropagation()}),i.appendChild(n);var c=bmElements.createElement("dropdown",{selected:y,onChange:function(e){y=e,browserStorage.sync.setItem(w+"OrderBy",e),a(),c.close()},items:[{id:"name",label:bmRuntime.i18n("cj_i18n_00092","Name")},{id:"modifiedTime desc",label:bmRuntime.i18n("cj_i18n_00093","Last modified")},{id:"modifiedByMeTime desc",label:bmRuntime.i18n("cj_i18n_00094","Last modified by me")},{id:"viewedByMeTime desc",label:bmRuntime.i18n("cj_i18n_00095","Last opened by me")}]}),l=cjMaterial.createElement("iconbutton",{label:bmRuntime.i18n("cj_i18n_00096","Order by"),iconName:"__mdi:cj_sort_by_alpha",onClick:function(){c.open()}});i.appendChild(l),l.addEventListener("click",function(e){e.stopPropagation()}),i.appendChild(c);var r=cjMaterial.createElement("iconbutton",{label:bmRuntime.i18n("cj_i18n_00106","Change view"),iconName:j?"__mdi:view_module":"__mdi:view_list",onClick:function(){j=!j,r.updateIcon({iconName:j?"__mdi:view_module":"__mdi:view_list"}),browserStorage.sync.setItem(w+"ThumbnailView",!j),a()}});return i.appendChild(r),i}function l(){var i=cjMaterial.createElement("drawer"),n=bmElements.createElement("servicelogo",{label:e.serviceName,color:"color"});i.appendChild(n);var t=bmElements.createElement("drawertabs",{items:E,onChange:function(e){bmRuntime.changeToPage(e),t.selected=C},selected:C});return i.appendChild(t),i}function r(){bmRuntime.toggleLoading("on",i);var n=bmElements.createElement("pageheader",{color:e.primaryColor,pageId:C,light:e.lightTheme,searchboxProperties:{onSubmit:function(){b===!1?o(!0):a()}}});i.appendChild(n),browserStorage.sync.get([w+"ThumbnailView",w+"FilterBy",w+"OrderBy"]).then(function(e){var t=e[w+"ThumbnailView"];"boolean"==typeof t&&(j=t);var o=e[w+"FilterBy"];"string"==typeof o&&(f=o);var r=e[w+"OrderBy"];"string"==typeof r&&(y=r);var d=c();i.appendChild(d),m=cjMaterial.createElement("container",{shadow:!0}),i.appendChild(m),u=l(),i.appendChild(u),s=n.searchbox,_(s.select),a()});var t=cjMaterial.createElement("fab",{label:bmRuntime.i18n("cj_i18n_00090","New file"),iconName:"__mdi:add",onClick:function(){bmRuntime.openTab(e.newFileUrl)}});i.appendChild(t)}var m,s,d,u,p,_=n.onPageDisplay,b=!1,h="",v="(mimeType = '"+e.mimeTypes.join("' or mimeType = '")+"')",f="all",y="lastOpenedByMe",w="pref"+e.pageId,j=e.listview,C=e.pageId,R=Promise.all([cjBasics.loadStyleFile("stylesheets/cjg-doclist.css"),cjBasics.loadScriptFile("scripts/cjg-doclist.js")]),T={all:null,owned:"'me' in owners",shared:"sharedWithMe"},N={name:"name",lastModified:"modifiedTime desc",lastModifiedByMe:"modifiedByMeTime desc",lastOpenedByMe:"viewedByMeTime desc"},E={docs:{label:bmRuntime.i18n("cj_i18n_00391","Docs"),iconName:"__mdi:drive_document",color:"#4285f4",colorIcon:!0,newTabUrl:"https://docs.google.com/document/u/"+g.account.authuser+"/",page:"docs"},sheets:{label:bmRuntime.i18n("cj_i18n_00393","Sheets"),iconName:"__mdi:drive_spreadsheet",color:"#34a853",colorIcon:!0,newTabUrl:"https://docs.google.com/spreadsheets/u/"+g.account.authuser+"/",page:"sheets"},slides:{label:bmRuntime.i18n("cj_i18n_00407","Slides"),iconName:"__mdi:drive_presentation",color:"#ffcd40",colorIcon:!0,newTabUrl:"https://docs.google.com/presentation/u/"+g.account.authuser+"/",page:"slides"},forms:{label:bmRuntime.i18n("cj_i18n_00408","Forms"),iconName:"__mdi:drive_form",color:"#673ab7",colorIcon:!0,newTabUrl:"https://docs.google.com/forms/u/"+g.account.authuser+"/",page:"forms",divider:!0}};"atari"===C&&(E.forms.divider=!1,E.sites={label:bmRuntime.i18n("cj_i18n_00111","Classic Sites"),iconName:"__mdi:cj_drive_sites",color:"#4285f4",colorIcon:!0,newTabUrl:"https://sites.google.com/u/"+g.account.authuser+"/",divider:!0}),E.drive={label:bmRuntime.i18n("cj_i18n_00390","Drive"),iconName:"__mdi:drive",newTabUrl:"https://drive.google.com/u/"+g.account.authuser+"/",divider:!0},g.auth.getAccessToken(["https://www.googleapis.com/auth/drive"])["catch"](function(n){i.textContent="";var t=bmElements.createElement("fulldialog",{serviceLogo:{label:e.serviceName},iconName:e.iconName,message:"Before you can use this page, you need to give the extension access to Google Drive",actionLabel:bmRuntime.i18n("cj_i18n_00224","Give permission"),action:n.authorize});i.appendChild(t)}),n.setOpenInNewHandler(function(){var i=e.mainUrl;b&&e.searchUrl&&(i=e.searchUrl+encodeURIComponent(h)),bmRuntime.openTab(i)}),r()}}});