!function(){"use strict";function e(e){P.then(function(){e(L)})}function n(e){L=e,browserStorage.sync.setItem("selected-services",e)}function t(e){L=L.concat(e),browserStorage.sync.setItem("selected-services",L)}function i(e){var n=cjMaterial.createElement("container");return n.classList.add("bm-p-"+e),n.dataset.id=e,cjBasics.isFirefox||n.addEventListener("mouseenter",function(){bmAnalytics.push(["_trackEvent","Page Mouseenter",e])}),n}function a(e){if("gplus"===e.id)return{label:"+"};if("gmail"===e.id)return{labelPrefix:"",label:"Gmail"};if("youtube"===e.id)return{labelPrefix:"",label:"YouTube"};var n=e.label;return e.labelI18n&&(n=bmRuntime.i18n(e.labelI18n,n)),"chromeapps"===e.id||"chrometopsites"===e.id?{labelPrefix:"",label:n}:{label:n}}function o(e){var n=e.serviceData;if(bmRuntime.standaloneService){var t=bmElements.createElement("pageheader",{pageTitle:n.label});n.body.appendChild(t)}var i=bmElements.createElement("fulldialog",{serviceLogo:a(n),iconName:n.iconName,message:e.message,actionLabel:e.actionLabel,action:e.action});n.body.appendChild(i)}function s(e){var n=h[e];n.body=i(e),("newtab"===bmRuntime.environment||bmRuntime.standaloneService)&&n.popup&&(n.body.classList.add("bm-page--popup"),n.body.addEventListener("click",function(e){e.stopPropagation()})),v.appendChild(n.body);var t;if(n.onPageDisplay=new Promise(function(e){t=e}),!n.loaded){n.loaded=!0;var a=[cjModules.require("/pages/"+e+"/index"),g.initialized];n.extraCss&&a.push(cjBasics.loadStyleFile("pages/"+e+"/index.css")),Promise.all(a).then(function(e){return!g.signedIn&&n.requireSignin?void o({serviceData:n,message:"To use Google "+n.label+",<br>sign in to your Google Account",actionLabel:"Sign in",action:g.accounts.add}):"none"===g.account.pageid||n.gplusPages?void e[0](n.body,{onPageDisplay:t,setOpenInNewHandler:function(e){n.openInNewCallback=e}}):void o({serviceData:n,message:"This service doesn't support Brand Accounts,<br>Switch to a non-page account",actionLabel:"Switch account",action:function(){c("account")}})})}}function c(e){document.documentElement.classList.remove("portal-expanded");var n=v.querySelector(".bm-page--popup.on");n&&n.classList.remove("on");var t=h[e];t.loaded||s(e),("newtab"===bmRuntime.environment||bmRuntime.standaloneService)&&t.popup?t.body.classList.add("on"):(E=v.selected||E,v.selected=e,dispatchEvent(y),t.onPageDisplay.then(function(n){e===v.selected&&setTimeout(n)}))}function r(){v=document.createElement("div"),v.className="main-window",v.addEventListener("click",function(){var e=v.querySelector(".bm-page--popup.on");e&&e.classList.remove("on")}),cjBasics.makeSelector(v),document.body.appendChild(v)}function d(e){var n;n=g.signedIn?cjgShortcuts.getUrl(e.shortcutId,g.account.authuser,g.account.pageid):cjgShortcuts.getUrl(e.shortcutId),bmRuntime.openTab(n),cjBasics.isFirefox||bmAnalytics.push(["_trackEvent","Open service in new tab",e.id])}function m(e){if(document.body.createTextRange){var n=document.body.createTextRange();return n.moveToElementText(e),void n.select()}if(window.getSelection){var t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)}}function l(e){var n=h[e],t=cjMaterial.createElement("item",{icon:{serviceName:n.iconName},label:n.label});n.menuItem=t,t.classList.add("page-menu-item"),t.dataset.id=e,"none"===g.account.pageid&&bmRuntime.portalOnSide&&(t.draggable=!0,cjBasics.isVivaldi&&t.addEventListener("mousedown",function(){m(document.body)}),t.addEventListener("dragstart",function(n){t.parentNode===bmRuntime.portalPageServicesList&&f.classList.add("on"),n.dataTransfer.setData("serviceId",e)})),t.addEventListener("touchstart",function(n){n.preventDefault(),n.stopPropagation(),c(e)});var i=cjMaterial.createElement("iconbutton",{iconName:"__mdi:open_in_new",label:bmRuntime.i18n("cj_i18n_00084","Open service in new tab"),onClick:function(e){d(n),e.stopPropagation()}});return i.classList.add("page-menu-item--open-in-new"),t.appendChild(i),t.addEventListener("click",function(n){if(t.parentNode===bmRuntime.portalPageServicesList)c(e);else if(t.parentNode===bmRuntime.customizePageServicesList){bmRuntime.selectedServices.add(e);var i=h.customize&&h.customize.menuItem;bmRuntime.portalPageServicesList.insertBefore(bmRuntime.servicePageData[e].menuItem,i)}else setTimeout(function(){c(e)},300);n.stopPropagation()}),t}function u(){var e=document.createElement("div");e.className="portal-sidebar bm-p-portal",e.addEventListener("click",function(){var e=v.querySelector(".bm-page--popup.on");e&&e.classList.remove("on")}),document.body.appendChild(e),Promise.all([cjBasics.loadStyleFile("pages/portal/index.css"),cjModules.require("/pages/portal/index"),S]).then(function(n){e.textContent="",n[1](e)})}function p(){f=document.createElement("div"),f.className="remove-page",f.dataset.label=bmRuntime.i18n("cj_i18n_00097","Drop here to remove"),f.addEventListener("drop",function(t){t.preventDefault(),f.classList.remove("on");var i=t.dataTransfer.getData("serviceId"),a=h[i].menuItem;bmRuntime.customizePageServicesList?bmRuntime.customizePageServicesList.appendChild(a):a.parentNode.removeChild(a),e(function(e){var t=e.indexOf(i);e.splice(t,1),n(e)})}),f.addEventListener("dragover",function(e){e.preventDefault()}),v.appendChild(f),window.addEventListener("dragleave",function(e){0===e.y&&f.classList.remove("on")})}function b(){function n(){document.documentElement.classList.toggle("mac-popup-fix"),t>0&&(setTimeout(n,i),t-=i)}if(cjBasics.isMac){var t=2500,i=250;n()}else cjBasics.loadStyleFile("stylesheets/scrollbar.css");browser.tabs.getCurrent().then(function(e){if("undefined"!=typeof e){var n=e.id;window.addEventListener("beforeunload",function(){browser.runtime.sendMessage({removeAllowedTabId:n})}),browser.runtime.sendMessage({addAllowedTabId:n})}}),document.body.addEventListener("click",function(e){if(e.target===document.body){var n=v.querySelector(".bm-page--popup.on");n&&n.classList.remove("on")}}),bmRuntime.createMenuItem=l,bmRuntime.changeToPage=c,bmRuntime.changeToPreviousPage=function(){c(E)},Object.defineProperty(window.bmRuntime,"servicePageData",{get:function(){return h}}),"popup"===bmRuntime.environment&&document.documentElement.classList.add("extension-popup"),"newtab"===bmRuntime.environment&&document.documentElement.classList.add("is-new-tab"),"options"===bmRuntime.environment&&document.documentElement.classList.add("options-popup"),"popup"===bmRuntime.environment&&bmRuntime.standaloneService&&"portal"!==bmRuntime.standaloneService&&document.documentElement.classList.add("single-popup"),g.initialized.then(function(){document.documentElement.classList.toggle("gauth-gplus-pages","none"!==g.account.pageid)}),r(),bmRuntime.standaloneService?S.then(function(){c(bmRuntime.standaloneService)}):(e(function(e){var n=e[0];c(n||"customize")}),document.documentElement.classList.add("portal-on-side"),u(),p()),cjBasics.isFirefox||bmAnalytics.init(),cjgModules.init(cjBasics.lang),g.init({key:"AIzaSyDFX55G5IhjeLMmMyovUCoJMU-aifNccv8",clientId:"494086030851-93vje778kogr9dnfq2hhli2e918p4hha.apps.googleusercontent.com",lang:cjBasics.lang}),browserStorage.sync.getItem("dense-mode").then(function(e){e===!0&&document.documentElement.classList.add("is-dense-mode")}),window.addEventListener("message",function(e){var n=location.origin.startsWith("moz-extension://")||location.origin.startsWith("chrome-extension://")||location.origin.endsWith(".google.com"),t=e.data.blackMenuOpenUrl;n&&t&&bmRuntime.openTab(t)})}var v,f,h,L,w=cjBasics.urls.getParameters(),y=new CustomEvent("bm-page-change"),R=browser.i18n.getMessage("@@extension_id");bmRuntime.standaloneService=w.page,bmRuntime.portalOnSide=!bmRuntime.standaloneService,bmRuntime.environment=w.environment,bmRuntime.isDev="mcehjneglbcohdablcifclpeaokebamb"===R;var E=bmRuntime.standaloneService||"search",S=cjBasics.ajax("pages.json",{fetchAs:"json"}).then(function(e){Object.keys(e).forEach(function(n){var t=e[n].labelI18n;t&&(e[n].label=bmRuntime.i18n(t,e[n].label))}),h=e}),j=browserStorage.sync.getItem("selected-services"),P=Promise.all([g.initialized,S]).then(function(){var e=Object.keys(h);return"none"!==g.account.pageid?e.filter(function(e){return h[e].gplusPages}):j.then(function(e){return Array.isArray(e)?e:"newtab"===bmRuntime.environment?["chromtopsites","chromebookmarks","calendar","keep","news","drive","gmail","tasks","maps","contacts"]:["search","gplus","translate","maps","youtube","news","gmail","drive","calendar","keep"]}).then(function(n){return n.filter(function(n){return e.indexOf(n)!==-1})})}).then(function(e){L=e});bmRuntime.selectedServices={get:e,set:n,add:t},"newtab"===bmRuntime.environment?window.addEventListener("DOMContentLoaded",b):window.addEventListener("load",function(){setTimeout(b)})}();